"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["33"],{1991:function(e,t,a){a.r(t),a.d(t,{PlanDetails:()=>d});var n=a(1925),i=a(3799),o=a(9144),r=a(8969),l=a(3812),c=a(3064),s=a(7718),p=a(43);let d=e=>(0,n.tZ)(l.SubscriberTypeContext.Provider,{value:e.subscriberType||"user",children:(0,n.tZ)(l.PlansContextProvider,{children:(0,n.tZ)(m,{...e})})}),m=({plan:e,onSubscriptionCancel:t,portalRoot:a,planPeriod:d="month"})=>{let m=(0,i.cL)(),{organization:h}=(0,i.o8)(),[g,b]=(0,o.useState)(!1),[y,D]=(0,o.useState)(!1),[x,B]=(0,o.useState)(),[S,Z]=(0,o.useState)(d),{setIsOpen:C}=(0,s.useDrawerContext)(),{activeOrUpcomingSubscription:v,revalidate:z,buttonPropsForPlan:k,isDefaultPlanImplicitlyActiveOrUpcoming:T}=(0,l.usePlansContext)(),K=(0,l.useSubscriberTypeContext)(),P=(0,r.N2)(e=>e({permission:"org:sys_billing:manage"})||"user"===K);if(!e)return null;let w=v(e),$=()=>{C&&C(!1)},f=e.features,F=f.length>0,L=async()=>{w&&(B(void 0),D(!0),await w.cancel({orgId:"org"===K?h?.id:void 0}).then(()=>{D(!1),t?.(),$()}).catch(e=>{(0,p.S3)(e,[],B),D(!1)}))},_=t=>{$();let n=t?.planPeriod||S;"annual"===n&&0===e.annualMonthlyAmount&&(n="month"),m.__internal_openCheckout({planId:e.id,planPeriod:n,subscriberType:K,onSubscriptionComplete:()=>{z()},portalRoot:a})};return(0,n.BX)(s.Drawer.Content,{children:[(0,n.tZ)(s.Drawer.Header,{sx:e=>F?null:{flex:1,borderBottomWidth:0,background:e.colors.$colorBackground},children:(0,n.tZ)(u,{plan:e,subscription:w,planPeriod:S,setPlanPeriod:Z,closeSlot:(0,n.tZ)(s.Drawer.Close,{})})}),F?(0,n.BX)(s.Drawer.Body,{children:[(0,n.tZ)(c.Text,{elementDescriptor:c.descriptors.planDetailCaption,variant:"caption",localizationKey:(0,c.localizationKeys)("commerce.availableFeatures"),colorScheme:"secondary",sx:e=>({padding:e.space.$4,paddingBottom:0})}),(0,n.tZ)(c.Box,{elementDescriptor:c.descriptors.planDetailFeaturesList,as:"ul",role:"list",sx:e=>({display:"grid",rowGap:e.space.$6,padding:e.space.$4,margin:0}),children:f.map(e=>(0,n.BX)(c.Box,{elementDescriptor:c.descriptors.planDetailFeaturesListItem,as:"li",sx:e=>({display:"flex",alignItems:"baseline",gap:e.space.$3}),children:[e.avatarUrl?(0,n.tZ)(s.Avatar,{size:e=>24,title:e.name,initials:e.name[0],rounded:!1,imageUrl:e.avatarUrl}):null,(0,n.BX)(c.Span,{elementDescriptor:c.descriptors.planDetailFeaturesListItemContent,children:[(0,n.tZ)(c.Text,{elementDescriptor:c.descriptors.planDetailFeaturesListItemTitle,colorScheme:"body",sx:e=>({fontWeight:e.fontWeights.$medium}),children:e.name}),e.description?(0,n.tZ)(c.Text,{elementDescriptor:c.descriptors.planDetailFeaturesListItemDescription,colorScheme:"secondary",sx:e=>({marginBlockStart:e.space.$0x25}),children:e.description}):null]})]},e.id))})]}):null,(e.isDefault||T)&&w?null:(0,n.tZ)(s.Drawer.Footer,{children:w?w.canceledAt?(0,n.tZ)(c.Button,{block:!0,textVariant:"buttonLarge",...k({plan:e}),onClick:()=>_()}):(0,n.BX)(c.Col,{gap:4,children:[w&&"month"===w.planPeriod&&e.annualMonthlyAmount>0?(0,n.tZ)(c.Button,{block:!0,variant:"bordered",colorScheme:"secondary",textVariant:"buttonLarge",isDisabled:!P,onClick:()=>_({planPeriod:"annual"}),localizationKey:(0,c.localizationKeys)("commerce.switchToAnnual")}):null,w&&"annual"===w.planPeriod?(0,n.tZ)(c.Button,{block:!0,variant:"bordered",colorScheme:"secondary",textVariant:"buttonLarge",isDisabled:!P,onClick:()=>_({planPeriod:"month"}),localizationKey:(0,c.localizationKeys)("commerce.switchToMonthly")}):null,(0,n.tZ)(c.Button,{block:!0,variant:"bordered",colorScheme:"danger",textVariant:"buttonLarge",isDisabled:!P,onClick:()=>b(!0),localizationKey:(0,c.localizationKeys)("commerce.cancelSubscription")})]}):(0,n.tZ)(c.Button,{block:!0,textVariant:"buttonLarge",...k({plan:e}),onClick:()=>_()})}),w?(0,n.BX)(s.Drawer.Confirmation,{open:g,onOpenChange:b,actionsSlot:(0,n.BX)(n.HY,{children:[!y&&(0,n.tZ)(c.Button,{variant:"ghost",size:"sm",textVariant:"buttonLarge",isDisabled:!P,onClick:()=>{B(void 0),b(!1)},localizationKey:(0,c.localizationKeys)("commerce.keepSubscription")}),(0,n.tZ)(c.Button,{variant:"solid",colorScheme:"danger",size:"sm",textVariant:"buttonLarge",isLoading:y,isDisabled:!P,onClick:()=>{B(void 0),b(!1),L()},localizationKey:(0,c.localizationKeys)("commerce.cancelSubscription")})]}),children:[(0,n.tZ)(c.Heading,{elementDescriptor:c.descriptors.drawerConfirmationTitle,as:"h2",textVariant:"h3",localizationKey:(0,c.localizationKeys)("commerce.cancelSubscriptionTitle",{plan:`${"upcoming"===w.status?"upcoming ":""}${w.plan.name}`})}),(0,n.tZ)(c.Text,{elementDescriptor:c.descriptors.drawerConfirmationDescription,colorScheme:"secondary",localizationKey:"upcoming"===w.status?(0,c.localizationKeys)("commerce.cancelSubscriptionNoCharge"):(0,c.localizationKeys)("commerce.cancelSubscriptionAccessUntil",{plan:w.plan.name,date:w.periodEnd})}),x&&(0,n.tZ)(s.Alert,{colorScheme:"danger",children:"string"==typeof x?x:x.message})]}):null]})},u=o.forwardRef((e,t)=>{let{plan:a,subscription:i,closeSlot:o,planPeriod:r,setPlanPeriod:p}=e,{captionForSubscription:d,isDefaultPlanImplicitlyActiveOrUpcoming:m,subscriptions:u}=(0,l.usePlansContext)(),h=m&&a.isDefault,g=!!i||h;return(0,n.BX)(c.Box,{ref:t,elementDescriptor:c.descriptors.planDetailHeader,sx:e=>({width:"100%",padding:e.space.$4,position:"relative"}),children:[o?(0,n.tZ)(c.Box,{sx:e=>({position:"absolute",top:e.space.$2,insetInlineEnd:e.space.$2}),children:o}):null,a.avatarUrl?(0,n.tZ)(s.Avatar,{boxElementDescriptor:c.descriptors.planDetailAvatar,size:e=>40,title:a.name,initials:a.name[0],rounded:!1,imageUrl:a.avatarUrl,sx:e=>({marginBlockEnd:e.space.$3})}):null,(0,n.BX)(c.Box,{sx:e=>({paddingInlineEnd:e.space.$10}),children:[(0,n.BX)(c.Flex,{gap:2,align:"center",children:[(0,n.tZ)(c.Heading,{elementDescriptor:c.descriptors.planDetailTitle,as:"h2",textVariant:"h2",children:a.name}),g?(0,n.tZ)(c.Flex,{elementDescriptor:c.descriptors.planDetailBadgeContainer,children:i?.status==="active"||h&&0===u.length?(0,n.tZ)(c.Badge,{elementDescriptor:c.descriptors.planDetailBadge,localizationKey:(0,c.localizationKeys)("badge__activePlan"),colorScheme:"secondary"}):(0,n.tZ)(c.Badge,{elementDescriptor:c.descriptors.planDetailBadge,localizationKey:(0,c.localizationKeys)("badge__upcomingPlan"),colorScheme:"primary"})}):null]}),a.description?(0,n.tZ)(c.Text,{elementDescriptor:c.descriptors.planDetailDescription,variant:"subtitle",colorScheme:"secondary",sx:e=>({marginTop:e.space.$1}),children:a.description}):null]}),(0,n.tZ)(c.Flex,{elementDescriptor:c.descriptors.planDetailFeeContainer,align:"center",wrap:"wrap",sx:e=>({marginTop:e.space.$3,columnGap:e.space.$1x5}),children:(0,n.BX)(n.HY,{children:[(0,n.BX)(c.Text,{elementDescriptor:c.descriptors.planDetailFee,variant:"h1",colorScheme:"body",children:[a.currencySymbol,i&&"annual"===i.planPeriod||"annual"===r?a.annualMonthlyAmountFormatted:a.amountFormatted]}),(0,n.tZ)(c.Text,{elementDescriptor:c.descriptors.planDetailFeePeriod,variant:"caption",colorScheme:"secondary",sx:e=>({textTransform:"lowercase",":before":{content:'"/"',marginInlineEnd:e.space.$1}}),localizationKey:(0,c.localizationKeys)("commerce.month")})]})}),!i||"month"===i.planPeriod&&a.annualMonthlyAmount>0?(0,n.tZ)(c.Box,{elementDescriptor:c.descriptors.planDetailPeriodToggle,sx:e=>({display:"flex",marginTop:e.space.$3}),children:(0,n.tZ)(s.Switch,{isChecked:"annual"===r,onChange:e=>p(e?"annual":"month"),label:(0,c.localizationKeys)("commerce.billedAnnually")})}):null,!!i&&(0,n.tZ)(c.Text,{elementDescriptor:c.descriptors.planDetailCaption,variant:"caption",localizationKey:d(i),colorScheme:"secondary",sx:e=>({marginTop:e.space.$3})})]})})}}]);